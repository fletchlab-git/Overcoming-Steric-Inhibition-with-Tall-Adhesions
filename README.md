**Monte Carlo Simulation for Membrane-Surface Interactions**
==================

Updated January 21, 2026

This repository contains the code and data necessary to reproduce figures from "Overcoming steric inhibition of antibody-dependent phagocytosis with tall adhesions
" by Aaron M. Joffe*, Aymeric Chorlay*, Jared Huzar, Jaffar Hasnain, Phillip L. Geissler, and Daniel A. Fletcher. This article is available in preprint form on BioxRiv at [https://www.biorxiv.org/content/10.1101/2024.08.25.609594v1](https://www.biorxiv.org/content/10.64898/2026.01.09.698749v1).

*These authors contributed equally.

Briefly, This readme describes the architecture of a Monte Carlo simulation code that models the interaction between a flexible membrane and a rigid surface, both decorated with adhesive and non-adhesive molecules.

### Three-Module Architecture

**Module 1: Monte Carlo Simulation**
The directory MC_Simulations contains a C code named "LatticeMembrane" (running on Linux) that executes the Monte Carlo simulation. Python programs in the directory 'runscripts' execute the MC simulations and allow users to adjust input parameters such as the protein height, density, and interactions of molecules on each surface. 

For each distance Z imposed by a bias potential between the two surfaces, the LatticeMembrane code performs Monte Carlo sweeps and calculates various quantities (bias energy, mesh energy, total energy, potential energy, membrane average separation, etc.) for each sweep. Results are stored in a data_Z_zvalue.dat file. All results are stored in a "Simulation_Results/DataFiles" folder containing one data_Z_zvalue.dat file for each imposed Z.

**Module 2: Free Energy Profile Calculation**

The "Free_Energy_Profile_Calculation.py" Python script analyzes the data generated by Module 1. It takes the "Simulation_Results/DataFiles" folder as input and calculates the free energy profile as a function of distance Z. The output is a Free_Energy.dat file containing the free energy F(Z) in the directory 'Free_Energies'.

**Module 3: Kinetic Rate Calculation**

The third Python script "Kinetic_Rate_Calculation.py" uses the free energy profiles from Free_Energy.dat to calculate the kinetic rate of short binder engagement, expressed as the ratio Kshort / Kdiff, where Kdiff represents the diffusion-limited kinetic rate. For each input F(Z) profile, the script generates a Kshort / Kdiff value and stores it in a Kinetic_Rate.csv file.


**Example Data**

Example results from MC simulations are provided in 'MC_Simulations/Simulation_Results/DataFiles'. Example free energy profile is included in the directory 'Free_Energies', and an example kinetic rate calculation output is included in the directory 'Kinetic_Rates'.
